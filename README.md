# 股票数据分析系统

基于 Python + PyQt5 + SQLite 构建的高性能股票数据分析桌面应用，支持海量数据（375万+条）的快速查询、统计分析和可视化展示。

## 功能特点

### 1. 数据管理
- ✅ 批量导入Excel文件（支持选择文件夹自动导入）
- ✅ 智能识别文件名中的日期（如：2025-09-01.xlsx）
- ✅ 增量导入，自动跳过已有数据
- ✅ 实时显示导入进度
- ✅ 数据验证和异常处理

### 2. 数据查询与展示
- ✅ 支持5000+行数据流畅滚动
- ✅ 所有列可排序（点击表头）
- ✅ 多维度筛选（日期、股票代码、板块）
- ✅ 关键字搜索（股票代码或名称）
- ✅ 数据高亮显示（主力流入/流出）

### 3. 数据分析
- ✅ 统计信息展示
- ✅ 主力净额分析
- ✅ 成交额对比
- ✅ 板块分布统计

### 4. 数据导出
- ✅ 导出当前查询结果到Excel
- ✅ 支持自定义导出路径

## 技术架构

- **编程语言**: Python 3.8+
- **GUI框架**: PyQt5
- **数据库**: SQLite
- **数据处理**: pandas + numpy
- **Excel处理**: openpyxl

## 安装说明

### 1. 安装Python环境

确保已安装 Python 3.8 或更高版本。

### 2. 安装依赖包

```bash
cd stock_analysis
pip install -r requirements.txt
```

### 3. 运行程序

```bash
python main.py
```

## 使用指南

### 1. 导入数据

1. 点击"批量导入数据"按钮
2. 选择包含Excel文件的文件夹
3. 点击"开始导入"
4. 等待导入完成

**文件名格式要求**：
- 推荐格式：`2025-09-01.xlsx`
- 也支持：`2025-09-01-5142.xlsx`

**Excel文件列名要求**：
- 交易日期（可选，会从文件名提取）
- 股票代码（必需）
- 股票名称（必需）
- 其他数据列（根据实际情况）

### 2. 查询数据

1. 在"交易日期"下拉框选择日期
2. （可选）输入股票代码或名称
3. （可选）选择板块
4. 点击"应用筛选"

### 3. 导出数据

1. 查询或筛选出需要的数据
2. 点击"导出到Excel"
3. 选择保存路径
4. 完成导出

## 数据库说明

- 数据库文件：`stock_data.db`（自动创建）
- 位置：与程序同目录
- 可以直接复制整个文件夹到其他电脑使用

## 打包成EXE

使用 PyInstaller 打包：

```bash
pyinstaller --onefile --windowed --name="股票分析系统" main.py
```

打包后的exe文件在 `dist` 目录下。

## 性能优化

- ✅ SQLite索引优化，查询速度快
- ✅ 多线程处理，界面永不卡顿
- ✅ 批量导入，效率高
- ✅ 分页显示，内存占用低

## 常见问题

### Q: 导入数据失败？
A: 请检查Excel文件格式是否正确，确保包含"股票代码"和"股票名称"列。

### Q: 数据量太大，查询慢？
A: 系统已优化，单次查询限制为10000条。如需查看更多数据，请使用筛选功能。

### Q: 如何备份数据？
A: 直接复制 `stock_data.db` 文件即可。

### Q: 如何分享给别人使用？
A: 可以打包成exe，或者直接将整个文件夹（包含数据库）发给别人。

## 开发者信息

- 版本：1.0.0
- 更新日期：2025-10-23

## 许可证

本项目仅供学术研究使用。

